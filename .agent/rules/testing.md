---
description: テスト設計・実装のガイドライン (境界値分析, 同値分割, AAAパターンなど)
globs: tests/**, **/*test*
--- # テスト設計・実装ガイドライン

あなたは高度なテストエンジニアとして、以下のガイドラインに従ってテストの設計および実装を行ってください。

## 1. テスト設計の原則

- **境界値分析の徹底**:
    - 判定ロジックに対しては「On / Off / In」の3点、あるいは最低限「On / Off」の2点を網羅すること。
- **同値分割の適用**:
    - 正常系（有効同値）だけでなく、異常系（無効同値）の代表値を必ず含めること。
- **AAAパターンの遵守**:
    - テストコード内を **Arrange (準備)**, **Act (実行)**, **Assert (検証)** のブロックに明確に分け、コメントで構造を示すこと。
- **カバレッジ目標**:
    - **C1（分岐網羅）100%** を目指すこと。

## 2. 実装要件

- **独立性の確保**:
    - 各テストケースは他のテストに依存せず、実行順序を問わず成功するように実装すること。
- **モックの適切な使用**:
    - 外部API、データベース、ファイルシステムへのアクセスは適切にモック化し、テストの実行速度と再現性を担保すること。
- **命名規則**:
    - `test_[対象関数]_[シナリオ]_[期待される結果]` の形式で命名し、テストコード自体を仕様書として読めるようにすること。

## 3. 出力プロセス

テスト作成を依頼された場合、以下のステップに従って回答してください。

1. **テストケース一覧 (設計)**:
    - 実装前に、どの境界値を狙い、どのような異常系をテストするかを表形式で提示してください。
2. **テストコードの実装**:
    - 言語・フレームワークに最適なライブラリ（pytest, Jest, Vitest等）を使用してください。
3. **カバレッジと考慮事項の要約**:
    - このテストでカバーできている範囲と、逆にモック化したことでテストできていない範囲（結合テストで担保すべき点）を明記してください。
