# フロントエンド品質監査 (Frontend Audit)

このドキュメントでは、React/Next.js コードベースの品質と設計ルールを維持するために導入された監査ツール (`npm run audit`) について説明します。

## 概要

`npm run audit` は、標準的な Linter では検出しにくい設計上の問題や、プロジェクト固有のルール遵守状況をチェックするためのコマンドです。
以下の2つのツールを組み合わせて実行されます。

1. **Biome (Ultracite)**: コードフォーマット、構文エラー、複雑度 (Complexity) のチェック
2. **Custom Audit Script**: 行数制限、State過多、YAGNI原則のチェック

## 実行方法

`web/frontend` ディレクトリで以下のコマンドを実行します。

```bash
npm run audit
```

## チェック項目詳細

### 1. 複雑度の制限 (Complexity check)

- **ツール**: Biome
- **ルール**: `complexity/noExcessiveCognitiveComplexity` (max: 20)
- **目的**: 読みやすくメンテナンスしやすいコードを保つため、条件分岐やネストが多い関数を警告します。
- **対処法**: 関数を小さく分割するか、条件ロジックを整理してください。

### 2. ファイル行数制限 (Component Size)

- **ツール**: Custom Script
- **ルール**: "コンポーネントは大体150行くらいまでにすること"
- **実装**: ファイル行数が **300行** を超える場合に警告を出します。（import文や型定義を含むため、少し緩めの設定です）
- **対処法**: UIの一部を別コンポーネントに切り出すか、ロジックをカスタムフックに移動してください。

### 3. State過多の検出 (State Overload)

- **ツール**: Custom Script
- **ルール**: "永続的にしろそうでないにしろ極力状態を持たないこと"
- **実装**: `useState` や `useReducer` の使用回数が **5回** を超えるコンポーネントに警告を出します。
- **対処法**: 複数のStateを `useReducer` にまとめるか、カスタムフックにロジックを分離してください。

### 4. 早期共通化の検出 (YAGNI / Premature Abstraction)

- **ツール**: Custom Script
- **ルール**: "必要になった時に必要なものを作ること" (早すぎる共通化を避ける)
- **実装**: `src/components` (共通フォルダ) にあるコンポーネントが、プロジェクト全体で **1回しか使用されていない** 場合に警告を出します。
- **対処法**: そのコンポーネントを使用しているページのディレクトリ（`src/app/...`）に移動（コロケーション）させてください。

## 設定

- **Biome設定**: `web/frontend/biome.json`
- **スクリプト本体**: `web/frontend/src/scripts/audit-rules.mjs`
