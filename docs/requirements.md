# 要件定義書 (Requirements Document)

**プロジェクト名**: aw-daily-reporter
**バージョン**: 0.2.0 (Draft)

---

## 1. はじめに

### 1.1 目的

ActivityWatch で収集した活動データを基に、拡張可能なプラグインシステムを通じて日報・タイムラインレポートを生成するツールを開発する。
ユーザーは Web UI または CLI から設定を管理し、カスタムプラグインによって機能を拡張できる。

### 1.2 ターゲットユーザー

- ActivityWatch を使用して活動ログを記録しているユーザー
- 日々の時間配分を把握・改善したいユーザー
- 独自のカテゴリ分類やレポート形式を必要とするユーザー

---

## 2. 機能要件 (Functional Requirements)

### FR-01: タイムラインレポート生成

- ActivityWatch から指定日のデータを取得し、タイムラインレポートを生成する
- 複数のデータソース（window, afk, vscode, web）を統合する
- 出力形式: Markdown（デフォルト）、JSON

### FR-02: プラグインシステム

- 3種類のプラグインをサポート:
  - **Processor**: タイムラインデータを加工
  - **Scanner**: 外部データを取得
  - **Renderer**: レポートを出力形式に変換
- ビルトインプラグインをパッケージに同梱
- ユーザープラグインを `~/.config/aw-daily-reporter/plugins/` から読み込み

### FR-03: プラグイン管理

- CLI: `aw-daily-reporter plugin list/install/remove`
- Web UI: プラグインの有効/無効切り替え、設定編集
- URL からの単一ファイルインストールをサポート

### FR-04: Web UI

- `aw-daily-reporter serve` で起動（ポート 5601）
- **使用パターン**: 通常は CLI でレポート出力するだけ。カテゴリ分類がイマイチな時だけ Web UI を起動して調整
- 機能:
  - ダッシュボード（レポートプレビュー）
  - プラグイン管理（有効/無効、設定編集）
  - カテゴリルール設定
  - プラグイン出力のデバッグ表示
  - 設定変更時のライブプレビュー

### FR-05: カテゴリ分類

- ルールベースのカテゴリ分類（アプリ名、タイトル、URL）
- ユーザーがルールを追加・編集可能
- 階層的なカテゴリ構造をサポート

---

## 3. 非機能要件 (Non-Functional Requirements)

### NFR-01: インストール容易性

- `pip install aw-daily-reporter` でインストール可能
- 外部依存を最小限に抑える

### NFR-02: 拡張性

- サードパーティプラグインの追加が容易
- プラグイン API が明確に定義されている

### NFR-03: 多言語対応

- UI およびレポートの日本語/英語サポート

### NFR-04: パフォーマンス

- 1日分のレポート生成は 5秒以内
- Web UI の応答は 500ms 以内

---

## 4. 制約事項 (Constraints)

- **データソース**: ローカルの ActivityWatch サーバー（aw-client 経由）
- **対応 Python バージョン**: 3.8 以上
- **プラグイン形式**: 単一 Python ファイル（Phase 1）

---

## 5. 将来の展望 (Out of Scope for Phase 1)

- **AI 連携**: タイムラインデータを AI に送信して日報を自動生成
- **週報/月報**: 複数日のデータを集計してトレンド分析
- **ActivityWatch UI 統合**: ActivityWatch の Web UI にタブとして統合
- **通知機能**: 作業時間の閾値超過時に通知
